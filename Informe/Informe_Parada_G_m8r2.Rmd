---
title: "Informe M8R2"
subtitle: "Esperanza de Vida y GDP en Suramérica (1875-2025)"
author: "Gabriel Parada"
date: "2025-08-08"
output: 
    html_document:
      toc: TRUE
      number_sections: TRUE
      toc_float: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning =  F, message = F, fig.width = 8, fig.height = 8)

```

# Paquetes

```{r}

library(knitr)
library(tidyr)
library(plotly)
library(readxl)
library(dplyr)
library(ggplot2)
library(here)
library(sf)
library(ggplot2)
library(plotly)
library(dplyr)
library(readr)
library(DT)
library(kableExtra)
library(gridExtra)



```

# Cargar los datos
```{r}
df_LA_GDP <- read.csv(here("Datos", "df_LA_GDP.csv"))

```
<br><br>

# Introducción

El presente trabajo investiga el nivel de la **esperanza de vida** desde el año 1875 hasta el 2025 en Suramérica y su relación con el **GDP per cápita (PPP)**. 

```{r, echo=FALSE}

# Crear tabla de conceptos:

tablaConceptos <- data.frame( GDP.per.cápita.PPP = c( "Es una medida de la producción económica per cápita de un país, ajustada por las diferencias en el costo de vida y los tipos de cambio entre países."),
                              Esperanza.de.Vida = c("La esperanza de vida es el número promedio de años que se espera que viva una persona desde su nacimiento, considerando las condiciones de mortalidad de un período específico.
"))

kable(tablaConceptos)
```
<br><br>

## Sobre los datos

El presente estudio une dos datasets:

1. **Life Expectancy Dataset v14:** Contiene datos sobre la esperanza de vida de todos los países del mundo compilados a partir de múltiples fuentes, principalmente del Instituto de Métricas y Evaluación de la Salud (IHME).

2. **GDP per capita in constant PPP dollars v31(PPP$2021):** Este provee datos históricos sobre el GDP per capita (Producto Interior Bruto per capita en español) para todos los países del mundo.

3. **Notas**: Ambos dataset tienen datos desde 1800 hasta 2100. Pero para este estudio se filtrarán los datos desde **1875 hasta 2025.**
<br><br>

# Estadísticas Descriptivas 1875-2025

```{r, echo=FALSE}
#Tabla de estadísticas descriptivas:

# Se le cambian los nombres a la tabla y se le quita una columna innecesaria
columnasN <- c("Países", "Año", "Esperanza_de_Vida", "GDP")
df_tablaI <- df_LA_GDP[-1] %>%
  filter(year >= 1875, year <= 2025)
colnames(df_tablaI) <- columnasN

df_tablaI %>% group_by(Países) %>% summarise(min.Esp.Vida=min(Esperanza_de_Vida), max.Esp.Vida = max(Esperanza_de_Vida),
                                             med.Esp.Vida=mean(Esperanza_de_Vida), min.GDP=min(GDP),
                                             max.GDP = max(GDP), med.GDP=mean(GDP),
                                             .groups = "drop") %>% kable(digits = 2) %>% kable_styling("striped")
```
<br><br>

```{r, echo = F}
#Tabla de datos para las funciones incrustadas en el texto

# Min, max y diferencia por país Esperanza de Vida y GDP (1875-2025)
resumen_pais <- df_tablaI %>%
    group_by(Países) %>%
    summarise(
        min.Esp.Vida = min(Esperanza_de_Vida, na.rm = TRUE),
        max.Esp.Vida = max(Esperanza_de_Vida, na.rm = TRUE),
        diff.Esp.Vida = max.Esp.Vida - min.Esp.Vida,
        min.GDP= min(GDP, na.rm = TRUE),
        max.GDP = max(GDP, na.rm = TRUE),
        diff.GDP = max.GDP - min.GDP,
        .groups = "drop"
    )

```


- Los `r length(unique(df_LA_GDP$country))` países del estudio han aumentado su esperanza de vida de promedio en 48.2 años en un periodo de `r rango <-range(df_tablaI$Año); abs(rango[1]-rango[2])` años.   

- Los `r length(unique(df_LA_GDP$country))` países del estudio han aumentado su `r colnames(df_tablaI[4]) ` promedio en 21783\$ dolares en un periodo de `r rango <-range(df_tablaI$Año); abs(rango[1]-rango[2])` años. 

- Aunque todos han seguido una tendencia al aumento de la Esperanza de Vida a la vez que aumenta su GDP, se observa que esto no es una relación perfecta, por ejemplo `r resumen_pais$Países[which.max(resumen_pais$max.Esp.Vida)]` es el país que alcanza la mayor Esperanza de Vida con `r max(resumen_pais$max.Esp.Vida)` años, teniendo uno de los GDP per cápita PPP más bajos del grupo. 

<br><br>


```{r, echo=FALSE, fig.align='center', fig.width = 7, fig.height = 6}

#por completar modificar

mediaSur <- data.frame(Países=rep("Suramérica",151),
                        Año=seq(1875, 2025))

df_m <- df_tablaI %>%
     group_by(Año) %>%
     summarise(Esperanza_de_Vida = mean(Esperanza_de_Vida, na.rm = T),
     GDP = mean(GDP, na.rm = T))

mediaSur <- mediaSur %>%
     left_join(df_m, by = "Año")


ggplot(mediaSur, aes(x = Esperanza_de_Vida)) +
  geom_histogram(aes(y = ..density..), fill = "lightblue", bins = 30, color = "white") +
  geom_density(color = "coral", size = 1.2) +
  labs(title = "Histograma Esperanza de vida en Suramérica (1875 - 2025)",
       x = "Esperanza de Vida en años",
       y = "Densidad") +
    scale_x_continuous(breaks = seq(0,100, by = 5))

```

- Al observar la distribución de densidad de la Esperanza de Vida de los países de Suramérica en los últimos `r rango <-range(df_tablaI$Año); abs(rango[1]-rango[2])` años se nota que un tercio de la misma se situa entre los 30 y 37.5 años.

- Luego incrementa rápidamente y se estabiliza un poco entre el rango de 70 a 80 años.


<br><br>


```{r, echo=FALSE, fig.align='center', fig.width = 7, fig.height = 6}
 
#Plot de Esperanza de vida por países
ggplot(df_tablaI, aes(x = Año, y = Esperanza_de_Vida, color = Países)) +
    geom_line(size = 1.2) +
    labs(
        title = "Esperanza de Vida por país (1875–2025)",
        x = "Año",
        y = "Esperanza de Vida (años)",
        color = "Países"
    ) +
    scale_x_continuous(breaks = seq(0, max(df_tablaI$Año), by = 25)) 

```

- Entre 1925 y 1935 se observa un rápido incremento en la Esperanza de Vida.

- Argentina es un outlier gozando de un incremento de la Esperanza de Vida desde 1890. Algunas de las razones fueron: Un crecimiento económico temprano, urbanización controlada y políticas de salud pública pioneras hicieron que cayera de forma drástica la mortalidad infantil.

- Bolivia y Guyana se han quedado rezagados en el aumento de la Esperanza de Vida. Guyana es uncaso interesante porque en los últimos años ha tenido un crecimiento económico acelerado, pero esto no se ha reflejado por los momentos en una mejora de la Esperanza de Vida.

<br><br>


```{r, echo=FALSE, fig.align='center', fig.width = 7, fig.height = 6}

 ggplot(df_tablaI, aes(x = Año, y = GDP, color = Países)) +
    geom_line(size = 1.2) +
    labs(
        title = "GDP per cápita PPP por país (1875–2025)",
        x = "Año",
        y = "GDP por país ($)",
        color = "Países"
    ) +
    scale_x_continuous(breaks = seq(0, max(df_tablaI$Año), by = 25)) 

```

- La tendencia general es que todos los países de Suramérica han aumentado su GDP per cápita PPP.

- Dos países son notables:

- Venezuela en terminos de GDP per cápita PPP fué entre los años 1950 y finales de la década de 1990 el país con mayor poder adquisitivo. Seguido por una grave crisis económica a inicios de la década del 2010.

- Guyana ha sido históricamente un país con un bajo GDP Per cápita PPP, pero en 2015 se descubrieron grandes pozos petroleros en sus costas. En el año 2019 empezó la explotación lo que ha aumentado su GDP per cápita PPP de 12800\$ en ese año hasta 72800\$ en el 2025 y se espera que continue este crecimiento económico.
<br><br>




```{r, echo=FALSE,  fig.width = 16, fig.height = 8}

# Gráfico de líneas para las variables

g1 <- ggplot(mediaSur, aes(x = Año, y = GDP, color = Países)) +
  geom_line(size = 1.7) +
  labs(
    title = "Media GDP per capita Suramérica (1875–2025)",
    x = "Año",
    y = "GDP per cápita ($)",
    color = "Países"
  ) +
    scale_x_continuous(breaks = seq(0, max(mediaSur$GDP), by = 25)) +
    theme(legend.position = "none",    
    plot.title = element_text(size = 20),  
    axis.title.x = element_text(size = 16), 
    axis.title.y = element_text(size = 16), 
 
    axis.text.x = element_text(size = 16), 
    axis.text.y = element_text(size = 14)) 


# Gráfico de líneas para las variables

g2 <- ggplot(mediaSur, aes(x = Año, y = Esperanza_de_Vida, color = Países)) +
  geom_line(size = 1.7,   col = "darkturquoise") +
  labs(
    title = "Media Esperanza de Vida Suramérica (1875–2025)",
    x = "Año",
    y = "Esperanza de Vida (años)",
    color = "Países"
  ) +
    scale_x_continuous(breaks = seq(0, max(mediaSur$Año), by = 25)) +
    theme(legend.position = "none",
          plot.title = element_text(size = 20),  
    axis.title.x = element_text(size = 16), 
    axis.title.y = element_text(size = 16), 
 
    axis.text.x = element_text(size = 16), 
    axis.text.y = element_text(size = 14))  

grid.arrange(g1, g2, ncol = 2)


```

- Luego de los años 1925 empieza un rápido incremento hasta llegar al promedio de `r round(mean(resumen_pais$max.Esp.Vida),2)` de hoy día.

- El GDP muestra una tendencia parecida. Desde 1930 aumenta hasta llegar a una media de `r format(mean(resumen_pais$max.GDP), scientific = FALSE)`\$.


<br><br>

# Correlación entre GDP per cápita y Esperanza de Vida Suramérica (1875-2025)

```{r, echo=FALSE, fig.align='center', fig.width = 7, fig.height = 6}
# Preparar datos
df_presente2 <- df_LA_GDP %>%
  filter(year >= 1875, year <= 2023)

# Plot de la correlación entre GDP per cápita y Esperanza de Vida
ggplot(df_presente2, aes(x = GDP, y = life_expectancy)) + 
  geom_point(col = "coral2") +
  geom_smooth(method = "lm", se = FALSE, col = "darkturquoise") +
  
  labs(x = "GDP per capita $", y = "Esperanza de Vida (años)", 
       title = "Correlación entre GDP per cápita y Esperanza de Vida") 

```

- Se observa una correlación positiva y fuerte entre el GDP per cápita PPP y la Esperanza de Vida de un país.

- El coeficiente de correlación de Pearson de ambas variables para Suramérica es de: `r cor_Infor <- cor.test(df_presente2$GDP, df_presente2$life_expectancy, method = "pearson"); round(cor_Infor$estimate,2)`.

- Aunque es fuerte y positivo, hay otras variables socio-económicas y ambientales que influyen en la Esperanza de Vida. Por ejemplo, el acceso a la sanidad pública, estilos de vida, nivel educativo.

- Hay outliers, por ejemplo, Argentina tenía entre los años 1900 hasta 1940 una Esperanza de Vida significativamente mayor a la media de Suramérica. De entre 8 y 20 años más.

- Por lo que a pesar de las condiciones económicas, es importante tomar responsabilidad en salud preventiva.
